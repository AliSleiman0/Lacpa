<style>
    .upload-area {
        border: 2px dashed rgba(56, 189, 248, 0.5);
        background: rgba(30, 41, 59, 0.5);
        border-radius: 12px;
        transition: all 0.3s ease;
        min-height: 180px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        position: relative;
    }

    .upload-area:hover {
        border-color: rgb(56, 189, 248);
        background: rgba(30, 41, 59, 0.7);
        box-shadow: 0 8px 24px rgba(56, 189, 248, 0.2);
    }

    .upload-area.dragover {
        border-color: rgb(56, 189, 248);
        background: rgba(56, 189, 248, 0.1);
        border-style: solid;
    }

    .upload-icon {
        color: rgba(148, 163, 184, 0.8);
        transition: all 0.3s ease;
    }

    .upload-area:hover .upload-icon {
        color: rgb(56, 189, 248);
        transform: translateY(-4px);
    }

    .file-input {
        display: none;
    }

    .upload-button {
        background: rgba(56, 189, 248, 0.1);
        border: 1px solid rgba(56, 189, 248, 0.3);
        color: rgb(56, 189, 248);
        transition: all 0.3s ease;
    }

    .upload-button:hover {
        background: rgba(56, 189, 248, 0.2);
        border-color: rgb(56, 189, 248);
    }

    .file-name {
        color: rgb(34, 197, 94);
        font-size: 14px;
        margin-top: 8px;
    }

    .submit-btn {
        background: linear-gradient(135deg, rgb(56, 189, 248) 0%, rgb(14, 165, 233) 100%);
        transition: all 0.3s ease;
    }

    .submit-btn:hover {
        background: linear-gradient(135deg, rgb(14, 165, 233) 0%, rgb(56, 189, 248) 100%);
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(56, 189, 248, 0.4);
    }

    .tab-button {
        transition: all 0.3s ease;
        color: rgba(148, 163, 184, 0.8);
    }

    .tab-button.active {
        color: rgb(56, 189, 248);
        position: relative;
    }

    .tab-button.active::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 2px;
        background: rgb(56, 189, 248);
    }
</style>

<div class="bg-[rgba(32, 32, 32, 1)] text-slate-200 min-h-screen px-4 pt-20 pb-12">
    <div class="max-w-[1400px] mx-auto">
        
        <!-- Page Header -->
        <div class="mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">How To Join LACPA</h1>
            <div class="flex gap-6 mb-6">
                <a href="/membership/apply-now" 
                   hx-get="http://localhost:3000/membership/apply-now" 
                   hx-target="#main-div" 
                   hx-swap="innerHTML" 
                   hx-push-url="/membership/apply-now"
                   hx-trigger="click"
                   class="tab-button text-base font-medium cursor-pointer">
                    Individual
                </a>
                <button class="tab-button active text-base font-medium cursor-pointer">
                    Firm
                </button>
            </div>
        </div>

        <!-- Apply To Firm Section -->
        <div class="mb-8 flex items-center justify-between">
            <h2 class="text-2xl font-bold text-sky-400">Apply To Firm</h2>
            <button type="submit" 
                    form="firm-application-form"
                    class="submit-btn px-8 py-3 rounded-lg font-semibold text-white shadow-lg">
                Apply Now
            </button>
        </div>

        <!-- Application Form -->
        <form id="firm-application-form" class="space-y-6">
            
            <!-- Row 1: Three upload areas -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <!-- Founding contract at the notary public -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Founding contract at the notary public</label>
                    <div class="upload-area" id="upload-1" onclick="document.getElementById('file-1').click()">
                        <input type="file" id="file-1" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-1"></div>
                    </div>
                </div>

                <!-- Company registration statement at the civil court -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Company registration statement at the civil court</label>
                    <div class="upload-area" id="upload-2" onclick="document.getElementById('file-2').click()">
                        <input type="file" id="file-2" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-2"></div>
                    </div>
                </div>

                <!-- Address form -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Address form</label>
                    <div class="upload-area" id="upload-3" onclick="document.getElementById('file-3').click()">
                        <input type="file" id="file-3" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-3"></div>
                    </div>
                </div>

            </div>

            <!-- Row 2: Three upload areas -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <!-- Copy of lease contract or ownership deed -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Copy of lease contract or ownership deed</label>
                    <div class="upload-area" id="upload-4" onclick="document.getElementById('file-4').click()">
                        <input type="file" id="file-4" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-4"></div>
                    </div>
                </div>

                <!-- Partners' identification documents -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Partners' identification documents</label>
                    <div class="upload-area" id="upload-5" onclick="document.getElementById('file-5').click()">
                        <input type="file" id="file-5" class="file-input" accept=".pdf,.doc,.docx" multiple />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-5"></div>
                    </div>
                </div>

                <!-- Payment of the required fees -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Payment of the required fees</label>
                    <div class="upload-area" id="upload-6" onclick="document.getElementById('file-6').click()">
                        <input type="file" id="file-6" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-6"></div>
                    </div>
                </div>

            </div>

            <!-- Row 3: One upload area -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <!-- Declaration of commitment to the Syndicate's law and internal regulations -->
                <div>
                    <label class="block text-sm text-slate-300 mb-3">Declaration of commitment to the Syndicate's law and internal regulations</label>
                    <div class="upload-area" id="upload-7" onclick="document.getElementById('file-7').click()">
                        <input type="file" id="file-7" class="file-input" accept=".pdf,.doc,.docx" />
                        <i class="fas fa-cloud-upload-alt text-5xl upload-icon mb-3"></i>
                        <p class="text-slate-400 text-sm mb-2">Drag and Drop</p>
                        <p class="text-slate-500 text-xs mb-3">Or</p>
                        <button type="button" class="upload-button px-4 py-2 rounded-lg text-sm font-medium">
                            Upload
                        </button>
                        <div class="file-name" id="file-name-7"></div>
                    </div>
                </div>

            </div>

        </form>

    </div>
</div>

<script>
// Handle file uploads with drag and drop
for (let i = 1; i <= 7; i++) {
    const uploadArea = document.getElementById(`upload-${i}`);
    const fileInput = document.getElementById(`file-${i}`);
    const fileName = document.getElementById(`file-name-${i}`);

    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });

    // Highlight drop area when item is dragged over it
    ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => {
            uploadArea.classList.add('dragover');
        }, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => {
            uploadArea.classList.remove('dragover');
        }, false);
    });

    // Handle dropped files
    uploadArea.addEventListener('drop', (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;
        fileInput.files = files;
        handleFiles(files, fileName);
    }, false);

    // Handle file input change
    fileInput.addEventListener('change', (e) => {
        handleFiles(e.target.files, fileName);
    });
}

function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
}

function handleFiles(files, fileNameElement) {
    if (files.length > 0) {
        const fileNames = Array.from(files).map(f => f.name).join(', ');
        fileNameElement.textContent = `âœ“ ${fileNames}`;
    }
}

// Handle form submission
document.getElementById('firm-application-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData();
    
    // Collect all files
    for (let i = 1; i <= 7; i++) {
        const fileInput = document.getElementById(`file-${i}`);
        if (fileInput.files.length > 0) {
            Array.from(fileInput.files).forEach(file => {
                formData.append(`file-${i}`, file);
            });
        }
    }

    try {
        const response = await fetch('/api/applications/firm', {
            method: 'POST',
            body: formData
        });

        if (response.ok) {
            alert('Application submitted successfully! We will review it within 7-10 business days.');
            // Optionally redirect
            // window.location.href = '/membership/apply-now';
        } else {
            alert('Error submitting application. Please try again.');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Error submitting application. Please try again.');
    }
});

// Re-initialize after HTMX swaps
document.body.addEventListener('htmx:afterSwap', function() {
    // Reinitialize drag and drop handlers
    console.log('HTMX swap completed');
});
</script>
