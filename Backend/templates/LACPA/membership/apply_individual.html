<style>
    /* Page Container */
    .application-container {
        min-height: 100vh;
        background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
        padding: 3rem 1rem;
    }

    /* Form Container */
    .form-container {
        max-width: 1200px;
        margin: 0 auto;
        background: rgba(20, 20, 40, 0.7);
        backdrop-filter: blur(10px);
        border-radius: 1rem;
        padding: 3rem 2rem;
        border: 1px solid rgba(14, 165, 233, 0.2);
    }

    /* Header */
    .form-header {
        text-align: center;
        margin-bottom: 3rem;
    }

    .form-title {
        color: #0ea5e9;
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .form-subtitle {
        color: #e2e8f0;
        font-size: 1rem;
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }

    .form-intro {
        color: #94a3b8;
        font-size: 0.9rem;
        margin-top: 1rem;
        line-height: 1.6;
    }

    /* Form Group */
    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-group label {
        display: block;
        color: #e2e8f0;
        font-weight: 400;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
    }

    .form-group input,
    .form-group select {
        width: 100%;
        padding: 0.75rem 1rem;
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(14, 165, 233, 0.3);
        border-radius: 0.375rem;
        color: #94a3b8;
        font-size: 0.9rem;
        transition: all 0.3s ease;
    }

    .form-group input:focus,
    .form-group select:focus {
        outline: none;
        border-color: #0ea5e9;
        background: rgba(15, 23, 42, 0.9);
    }

    .form-group input::placeholder {
        color: #475569;
    }

    /* Grid Layouts */
    .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    .grid-3 {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 1rem;
    }

    .grid-4 {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1rem;
    }

    @media (max-width: 768px) {
        .grid-2, .grid-3, .grid-4 {
            grid-template-columns: 1fr;
        }
    }

    /* Section Divider */
    .section-divider {
        border-top: 1px solid rgba(14, 165, 233, 0.2);
        margin: 2.5rem 0;
    }

    /* Section Title */
    .section-title {
        color: #e2e8f0;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
    }

    /* Add Button */
    .add-btn {
        background: rgba(14, 165, 233, 0.1);
        color: #0ea5e9;
        border: 1px solid rgba(14, 165, 233, 0.3);
        padding: 0.5rem 1.5rem;
        border-radius: 2rem;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 1rem;
    }

    .add-btn:hover {
        background: rgba(14, 165, 233, 0.2);
        transform: translateY(-2px);
    }

    /* Upload Button */
    .upload-btn {
        background: rgba(14, 165, 233, 0.1);
        color: #0ea5e9;
        border: 1px solid rgba(14, 165, 233, 0.3);
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-block;
    }

    .upload-btn:hover {
        background: rgba(14, 165, 233, 0.2);
    }

    /* Submit Button */
    .submit-btn {
        background: rgba(71, 85, 105, 0.8);
        color: #e2e8f0;
        padding: 0.75rem 3rem;
        border-radius: 2rem;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        display: block;
        margin: 3rem auto 0;
    }

    .submit-btn:hover {
        background: rgba(71, 85, 105, 1);
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    /* Alternative Email Link */
    .alt-email-link {
        color: #0ea5e9;
        font-size: 0.85rem;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        margin-top: 0.5rem;
    }

    .alt-email-link:hover {
        text-decoration: underline;
    }

    /* Certificate Row */
    .certificate-row {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr auto;
        gap: 1rem;
        align-items: end;
        margin-bottom: 1rem;
    }

    @media (max-width: 768px) {
        .certificate-row {
            grid-template-columns: 1fr;
        }
    }
</style>

<div class="application-container">
    <div class="form-container">
        
        <!-- Form Header -->
        <div class="form-header">
            <h1 class="form-title">Join LACPA</h1>
            <h2 class="form-subtitle">Article 8 & 9 Of The Law Regulating The Profession Of Accounting Experts</h2>
            <h3 class="form-subtitle">Law No. 364 Dated August 1, 1994</h3>
            <p class="form-intro">
                To The Esteemed President And Members Of The Syndicate Council,<br><br>
                I Request My Registration In The Apprenticeship Category Of The Syndicate, In Accordance With The Provisions Of The Law Regulating The Profession Of Accounting Experts In Lebanon, Law No. 364/94, And Pursuant To The Required Supporting Documents:
            </p>
        </div>

        <!-- Application Form -->
        <form id="individual-application-form">
            
            <!-- Basic Information -->
            <div class="grid-4">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" name="name" placeholder="Name">
                </div>
                <div class="form-group">
                    <label>Father's Name</label>
                    <input type="text" name="fatherName" placeholder="Name">
                </div>
                <div class="form-group">
                    <label>Mother's Name</label>
                    <input type="text" name="motherName" placeholder="Name">
                </div>
                <div class="form-group">
                    <label>Family Name (Surname)</label>
                    <input type="text" name="familyName" placeholder="Name">
                </div>
            </div>

            <div class="grid-3">
                <div class="form-group">
                    <label>Place of Civil Registry & Town</label>
                    <input type="text" name="civilRegistryPlace" placeholder="Place">
                </div>
                <div class="form-group">
                    <label>Civil Registry Number</label>
                    <input type="text" name="civilRegistryNumber" placeholder="Number">
                </div>
                <div class="form-group">
                    <label>Date of Birth</label>
                    <input type="text" name="dateOfBirth" placeholder="DD/MM/YYYY">
                </div>
            </div>

            <div class="section-divider"></div>

            <!-- Residential Address -->
            <div class="section-title">Residential Address</div>
            <div class="grid-4">
                <div class="form-group">
                    <label>Governorate</label>
                    <input type="text" name="residentialGovernorate" placeholder="Governorate">
                </div>
                <div class="form-group">
                    <label>District</label>
                    <input type="text" name="residentialDistrict" placeholder="District">
                </div>
                <div class="form-group">
                    <label>Town</label>
                    <input type="text" name="residentialTown" placeholder="Town">
                </div>
                <div class="form-group">
                    <label>Building</label>
                    <input type="text" name="residentialBuilding" placeholder="Building">
                </div>
            </div>

            <div class="grid-4">
                <div class="form-group">
                    <label>Ownership</label>
                    <input type="text" name="residentialOwnership" placeholder="Ownership">
                </div>
                <div class="form-group">
                    <label>Street</label>
                    <input type="text" name="residentialStreet" placeholder="Street">
                </div>
                <div class="form-group">
                    <label>Floor</label>
                    <input type="text" name="residentialFloor" placeholder="Floor">
                </div>
                <div class="form-group">
                    <label>Neighborhood</label>
                    <input type="text" name="residentialNeighborhood" placeholder="Neighborhood">
                </div>
            </div>

            <div class="grid-3">
                <div class="form-group">
                    <label>Telephone</label>
                    <input type="tel" name="residentialTelephone" placeholder="Telephone">
                </div>
                <div class="form-group">
                    <label>Personal Mobile</label>
                    <input type="tel" name="personalMobile" placeholder="Personal Mobile">
                </div>
                <div class="form-group">
                    <label>Personal Email</label>
                    <input type="email" name="personalEmail" placeholder="Personal Email">
                </div>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label>Governorate</label>
                    <input type="text" name="governorate" placeholder="Name">
                </div>
                <div class="form-group">
                    <label>Name of Supervising Expert</label>
                    <input type="text" name="supervisingExpert" placeholder="Name">
                </div>
            </div>

            <div class="form-group">
                <label>Syndicate Registration No</label>
                <input type="text" name="syndicateRegistrationNo" placeholder="Number">
            </div>

            <div class="section-divider"></div>

            <!-- Office Address -->
            <div class="section-title">Office Address</div>
            <div class="grid-4">
                <div class="form-group">
                    <label>Governorate</label>
                    <input type="text" name="officeGovernorate" placeholder="Governorate">
                </div>
                <div class="form-group">
                    <label>District</label>
                    <input type="text" name="officeDistrict" placeholder="District">
                </div>
                <div class="form-group">
                    <label>Town</label>
                    <input type="text" name="officeTown" placeholder="Town">
                </div>
                <div class="form-group">
                    <label>Building</label>
                    <input type="text" name="officeBuilding" placeholder="Building">
                </div>
            </div>

            <div class="grid-4">
                <div class="form-group">
                    <label>Ownership</label>
                    <input type="text" name="officeOwnership" placeholder="Ownership">
                </div>
                <div class="form-group">
                    <label>Street</label>
                    <input type="text" name="officeStreet" placeholder="Street">
                </div>
                <div class="form-group">
                    <label>Floor</label>
                    <input type="text" name="officeFloor" placeholder="Floor">
                </div>
                <div class="form-group">
                    <label>Neighborhood</label>
                    <input type="text" name="officeNeighborhood" placeholder="Neighborhood">
                </div>
            </div>

            <div class="grid-4">
                <div class="form-group">
                    <label>P.O. Box</label>
                    <input type="text" name="poBox" placeholder="Address">
                </div>
                <div class="form-group">
                    <label>Telephone (1)</label>
                    <input type="tel" name="officeTelephone1" placeholder="Telephone">
                </div>
                <div class="form-group">
                    <label>Telephone (2)</label>
                    <input type="tel" name="officeTelephone2" placeholder="Telephone">
                </div>
                <div class="form-group">
                    <label>Telephone (3)</label>
                    <input type="tel" name="officeTelephone3" placeholder="Telephone">
                </div>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label>Office Email</label>
                    <input type="email" name="officeEmail" placeholder="Email">
                </div>
                <div class="form-group">
                    <label>Fax</label>
                    <input type="text" name="fax" placeholder="Number">
                </div>
            </div>

            <div class="section-divider"></div>

            <!-- Academic or Professional Certificates -->
            <div class="section-title">Academic or Professional Certificates</div>
            <div id="academic-certificates">
                <div class="certificate-row">
                    <div class="form-group">
                        <label>Academic Information</label>
                        <input type="text" name="academicInfo[]" placeholder="Name">
                    </div>
                    <div class="form-group">
                        <label>Degree</label>
                        <select name="academicDegree[]">
                            <option value="">Select</option>
                            <option value="bachelor">Bachelor</option>
                            <option value="master">Master</option>
                            <option value="phd">PhD</option>
                            <option value="diploma">Diploma</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Field of Study</label>
                        <select name="fieldOfStudy[]">
                            <option value="">Select</option>
                            <option value="accounting">Accounting</option>
                            <option value="finance">Finance</option>
                            <option value="business">Business</option>
                            <option value="economics">Economics</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Degree Date</label>
                        <input type="text" name="degreeDate[]" placeholder="Date">
                    </div>
                    <div class="form-group">
                        <label>Certification</label>
                        <button type="button" class="upload-btn">Upload</button>
                    </div>
                </div>
            </div>
            <button type="button" class="add-btn" onclick="addAcademicCertificate()">Add</button>

            <div class="section-divider"></div>

            <!-- Professional Certificates -->
            <div class="section-title">Professional Certificates</div>
            <div id="professional-certificates">
                <div class="certificate-row">
                    <div class="form-group">
                        <label>Institute/ Association</label>
                        <input type="text" name="professionalInstitute[]" placeholder="Name">
                    </div>
                    <div class="form-group">
                        <label>Certificate</label>
                        <select name="professionalCertificate[]">
                            <option value="">Select</option>
                            <option value="cpa">CPA</option>
                            <option value="cma">CMA</option>
                            <option value="cia">CIA</option>
                            <option value="cfa">CFA</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Degree Date</label>
                        <input type="text" name="professionalDegreeDate[]" placeholder="Date">
                    </div>
                    <div class="form-group">
                        <label>Certification</label>
                        <button type="button" class="upload-btn">Upload</button>
                    </div>
                </div>
            </div>
            <button type="button" class="add-btn" onclick="addProfessionalCertificate()">Add</button>

            <div class="section-divider"></div>

            <!-- Date and Signature -->
            <div class="section-title">Date and Signature</div>
            <div class="form-group">
                <label>Date</label>
                <input type="text" name="submissionDate" placeholder="9/25/2025">
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label>Syndicate No.</label>
                    <input type="text" name="syndicateNo1" placeholder="Number">
                </div>
                <div class="form-group">
                    <label>Introducing Expert 1</label>
                    <input type="text" name="introducingExpert1" placeholder="Name">
                </div>
            </div>
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" name="introducingExpert1Email" placeholder="Email">
                <a href="#" class="alt-email-link">Add Alternative Email</a>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label>Syndicate No.</label>
                    <input type="text" name="syndicateNo2" placeholder="Number">
                </div>
                <div class="form-group">
                    <label>Introducing Expert 2</label>
                    <input type="text" name="introducingExpert2" placeholder="Name">
                </div>
            </div>
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" name="introducingExpert2Email" placeholder="Email">
                <a href="#" class="alt-email-link">Add Alternative Email</a>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="submit-btn">Submit</button>

        </form>

    </div>
</div>

<script>
    // Add Academic Certificate Row
    function addAcademicCertificate() {
        const container = document.getElementById('academic-certificates');
        const newRow = document.createElement('div');
        newRow.className = 'certificate-row';
        newRow.innerHTML = `
            <div class="form-group">
                <label>Academic Information</label>
                <input type="text" name="academicInfo[]" placeholder="Name">
            </div>
            <div class="form-group">
                <label>Degree</label>
                <select name="academicDegree[]">
                    <option value="">Select</option>
                    <option value="bachelor">Bachelor</option>
                    <option value="master">Master</option>
                    <option value="phd">PhD</option>
                    <option value="diploma">Diploma</option>
                </select>
            </div>
            <div class="form-group">
                <label>Field of Study</label>
                <select name="fieldOfStudy[]">
                    <option value="">Select</option>
                    <option value="accounting">Accounting</option>
                    <option value="finance">Finance</option>
                    <option value="business">Business</option>
                    <option value="economics">Economics</option>
                </select>
            </div>
            <div class="form-group">
                <label>Degree Date</label>
                <input type="text" name="degreeDate[]" placeholder="Date">
            </div>
            <div class="form-group">
                <label>Certification</label>
                <button type="button" class="upload-btn">Upload</button>
            </div>
        `;
        container.appendChild(newRow);
    }

    // Add Professional Certificate Row
    function addProfessionalCertificate() {
        const container = document.getElementById('professional-certificates');
        const newRow = document.createElement('div');
        newRow.className = 'certificate-row';
        newRow.innerHTML = `
            <div class="form-group">
                <label>Institute/ Association</label>
                <input type="text" name="professionalInstitute[]" placeholder="Name">
            </div>
            <div class="form-group">
                <label>Certificate</label>
                <select name="professionalCertificate[]">
                    <option value="">Select</option>
                    <option value="cpa">CPA</option>
                    <option value="cma">CMA</option>
                    <option value="cia">CIA</option>
                    <option value="cfa">CFA</option>
                </select>
            </div>
            <div class="form-group">
                <label>Degree Date</label>
                <input type="text" name="professionalDegreeDate[]" placeholder="Date">
            </div>
            <div class="form-group">
                <label>Certification</label>
                <button type="button" class="upload-btn">Upload</button>
            </div>
        `;
        container.appendChild(newRow);
    }

    // Form submission
    document.getElementById('individual-application-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        
        // Convert form data to JSON
        const data = {};
        formData.forEach((value, key) => {
            if (key.endsWith('[]')) {
                const arrayKey = key.slice(0, -2);
                if (!data[arrayKey]) {
                    data[arrayKey] = [];
                }
                data[arrayKey].push(value);
            } else {
                data[key] = value;
            }
        });
        
        try {
            const response = await fetch('http://localhost:3000/api/applications/individual', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });
            
            const result = await response.json();
            
            if (response.ok) {
                alert('Application submitted successfully! We will review it within 5-7 business days.');
                // Redirect back to requirements page
                htmx.ajax('GET', 'http://localhost:3000/membership/apply-now', {
                    target: '#main-div',
                    swap: 'innerHTML'
                });
            } else {
                alert('Error: ' + (result.message || 'Failed to submit application'));
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while submitting your application. Please try again.');
        }
    });

    // Alternative email link handling
    document.querySelectorAll('.alt-email-link').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const emailGroup = this.parentElement;
            const newEmailInput = document.createElement('input');
            newEmailInput.type = 'email';
            newEmailInput.name = emailGroup.querySelector('input').name + '_alt';
            newEmailInput.placeholder = 'Alternative Email';
            newEmailInput.className = emailGroup.querySelector('input').className;
            newEmailInput.style.marginTop = '0.5rem';
            emailGroup.insertBefore(newEmailInput, this);
            this.style.display = 'none';
        });
    });
</script>
